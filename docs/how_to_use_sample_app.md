# How to use sample app

After installation, you can check the sample page which you can check live streaming from your IoT device and some metrics (cpu utilization etc.). Please be sure that [installation procedure](./how_to_install.md) is completely finished before.

## start processes on your IoT device

Here, we assume that SSG and SiRu-device is installed in your home directory.

* janus gateway

```bash
/opt/janus/bin/janus
```

* SSG

```bash
node skyway-signaling-gateway/app
```

* Test Video Streaming Process

**Raspbian**

```bash
gst-launch-1.0 videotestsrc ! \
  video/x-raw,width=640,height=480,framerate=30/1 ! \
  videoscale ! videorate ! videoconvert ! timeoverlay ! \
  omxh264enc target-bitrate=2000000 control-rate=variable ! \
  h264parse ! rtph264pay config-interval=1 pt=96 ! \
    udpsink host=127.0.0.1 port=5004 \
audiotestsrc ! \
  audioconvert ! queue ! \
  audioresample ! \
  audio/x-raw,channels=1,rate=16000 ! \
  opusenc bitrate=20000 ! \
    rtpopuspay ! udpsink host=127.0.0.1 port=5002
```

**Ubuntu16.04**

```bash
gst-launch-1.0 videotestsrc ! \
  video/x-raw,width=640,height=480,framerate=30/1 ! \
  timeoverlay ! \
  x264enc aud=false key-int-max=1 tune=zerolatency intra-refresh=true ! \
  "video/x-h264,profile=constrained-baseline,level=(string)3.1" ! \
  rtph264pay pt=96 ! \
  capssetter caps='application/x-rtp,profile-level-id=(string)42e01f' ! \
  udpsink host=127.0.0.1 port=5004
audiotestsrc ! \
  audioconvert ! queue ! \
  audioresample ! \
  audio/x-raw,channels=1,rate=16000 ! \
  opusenc bitrate=20000 ! \
    rtpopuspay ! udpsink host=127.0.0.1 port=5002
```

* sample 3rd party app

```bash
$ node skyway-siru-device/examples/metrics
```

## Try sample web app

Before trying to access sample web app, you need to set ``nttcom.github.io`` in your SkyWay API Key settings (available domain).

To check installation is completely finished and your environment working properly, you can use our sample web site.

https://nttcom.github.io/skyway-siru-sample/dist/

1st time, you would see the blank form. Please input your APIKEY which is same as configured in ``skyway-signaling-gateway/conf/skyway.yaml`` and ROOMNAME as ``testroom``.

Then you would see the test video stream and realtime metrics as shwon below.

![sample app screenshot with test src](https://nttcom.github.io/skyway-iot-sdk/images/iot_sample_app_bar.png)

## Change video source - real camera

Above setting, you could check the test video and audio streaming which is generated from your IoT device. Yes it is ok, but you would enjoy if you could see the real media streaming which is generated by camera and mic. We'll show you how to do that.

If you have USB camera and mic inside, plug it to your IoT device.

Then stop current Streaming Process wth Ctrl+C then execute other process which is for usb camera.

**Raspbian**

```bash
gst-launch-1.0 v4l2src device=/dev/video0 ! \
  video/x-raw,width=640,height=480,framerate=30/1 ! \
  videoscale ! videorate ! videoconvert ! timeoverlay ! \
  omxh264enc target-bitrate=2000000 control-rate=variable ! \
  h264parse ! rtph264pay config-interval=1 pt=96 ! \
    udpsink host=127.0.0.1 port=5004
```

**Ubuntu16.04**

```bash
gst-launch-1.0 v4l2src device=/dev/video0 ! \
  video/x-raw,width=640,height=480,framerate=15/1 ! \
  timeoverlay ! \
  x264enc aud=false key-int-max=1 tune=zerolatency intra-refresh=true ! \
  "video/x-h264,profile=constrained-baseline,level=(string)3.1" ! \
  rtph264pay pt=96 ! \
  capssetter caps='application/x-rtp,profile-level-id=(string)42e01f' ! \
  udpsink host=127.0.0.1 port=5004
```

Then, you may see that video view automatically changed from test video to real camera.

![sample app screenshot with usb cam](https://nttcom.github.io/skyway-iot-sdk/images/iot_sample_app_me.png)

## Next Step

Now your SkyWay IoT SDK environment is properly working. Next step is to learn how to build your own app with SDK.
* [Getting Started - SkyWay IoT Room Utility(SiRu)](./how_to_use_siru.md)

---
Copyright. NTT Communications All Rights Reserved.
